using System;
using System.Text.RegularExpressions;
using System.Net;

public static class InputSanitizer
{
    public static string SanitizeUsername(string username)
    {
        if (string.IsNullOrWhiteSpace(username))
            throw new ArgumentException("Username is required.");

        // Allow only letters and numbers (3â€“50 characters)
        if (!Regex.IsMatch(username, @"^[a-zA-Z0-9]{3,50}$"))
            throw new ArgumentException("Invalid username format.");

        return username;
    }

    public static string SanitizeEmail(string email)
    {
        if (string.IsNullOrWhiteSpace(email))
            throw new ArgumentException("Email is required.");

        if (!Regex.IsMatch(email, @"^[^@\s]+@[^@\s]+\.[^@\s]+$"))
            throw new ArgumentException("Invalid email format.");

        return email;
    }

    // Prevent XSS when rendering output
    public static string EncodeForOutput(string input)
    {
        return WebUtility.HtmlEncode(input);
    }
}
