public class AuthService
{
    private readonly UserRepository _userRepository;
    private readonly PasswordService _passwordService;

    public AuthService(UserRepository userRepository, PasswordService passwordService)
    {
        _userRepository = userRepository;
        _passwordService = passwordService;
    }

    public bool Authenticate(string username, string password)
    {
        var user = _userRepository.GetUserByUsername(username);

        if (user == null)
            return false;

        return _passwordService.VerifyPassword(password, user.PasswordHash);
    }
}
